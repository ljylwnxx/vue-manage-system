{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport CommonForm from '../../components/CommonForm.vue';\nimport CommonTable from '../../components/CommonTable.vue';\nimport { getUser } from \"../../../api/data\";\nexport default {\n  name: \"User\",\n  components: {\n    CommonForm,\n    CommonTable\n  },\n\n  data() {\n    return {\n      operateType: \"add\",\n      isShow: false,\n      operateFormLabel: [{\n        model: \"name\",\n        label: \"姓名\",\n        type: \"input\"\n      }, {\n        model: \"age\",\n        label: \"年龄\",\n        type: \"input\"\n      }, {\n        model: \"sex\",\n        label: \"性别\",\n        type: \"select\",\n        opts: [{\n          label: \"男\",\n          value: 1\n        }, {\n          label: \"女\",\n          value: 0\n        }]\n      }, {\n        model: \"birth\",\n        label: \"出生日期\",\n        type: \"date\"\n      }, {\n        model: \"addr\",\n        label: \"地址\",\n        type: \"input\"\n      }],\n      operateForm: {\n        name: \"\",\n        addr: \"\",\n        age: \"\",\n        birth: \"\",\n        sex: \"\"\n      },\n      formLabel: [{\n        model: \"keyword\",\n        label: \"\",\n        type: \"input\"\n      }],\n      searchForm: {\n        keyword: \"\"\n      },\n      tableData: [],\n      tableLabel: [{\n        prop: \"name\",\n        label: \"姓名\"\n      }, {\n        prop: \"age\",\n        label: \"年龄\"\n      }, {\n        prop: \"sexLabel\",\n        label: \"性别\"\n      }, {\n        prop: \"birth\",\n        label: \"出生日期\",\n        width: 200\n      }, {\n        prop: \"addr\",\n        label: \"地址\",\n        width: 320\n      }],\n      config: {\n        page: 1,\n        total: 30\n      }\n    };\n  },\n\n  methods: {\n    confirm() {\n      //判断当前为编辑还是新增\n      if (this.operateType === \"edit\") {\n        //更新table数组\n        this.$http.post(\"/user/edit\", this.operateForm).then(res => {\n          console.log(\"编辑\" + res);\n          this.isShow = false;\n          this.getList();\n        });\n      } else {\n        this.$http.post(\"/user/add\", this.operateForm).then(res => {\n          console.log(\"新增\" + res);\n          this.isShow = false;\n          this.getList();\n        });\n      }\n    },\n\n    addUser() {\n      this.isShow = true;\n      this.operateType = \"add\";\n      this.operateForm = {\n        name: \"\",\n        addr: \"\",\n        age: \"\",\n        birth: \"\",\n        sex: \"\"\n      };\n    },\n\n    editUser(row) {\n      this.operateType = \"edit\";\n      this.isShow = true;\n      this.operateForm = row;\n    },\n\n    delUser(row) {\n      this.$confirm(\"此操作将永久删除该数据，是否继续\", \"提示\", {\n        confirmButtonText: \"确认\",\n        cancelButtonText: \"取消\",\n        //弹窗类型\n        type: \"warning\"\n      }).then(() => {\n        const id = row.id;\n        this.$http.get(\"/user/del\", {\n          params: {\n            id\n          }\n        }).then(() => {\n          this.$message({\n            type: \"success\",\n            message: \"删除成功\"\n          });\n        });\n        this.getList();\n      });\n    },\n\n    //获取列表\n    getList(name = \"\") {\n      this.config.loading = true;\n      name ? this.config.page = 1 : \"\";\n      getUser({\n        page: this.config.page,\n        name\n      }).then(res => {\n        //需要拿到的数据是res.data.list；解构赋值 给data起名为res\n        console.log(res.data);\n        this.tableData = res.data.list.map(item => {\n          item.sexLabel = item.sex === 0 ? \"女\" : \"男\";\n          return item;\n        });\n        this.config.total = res.data.count;\n        this.config.loading = false;\n      });\n    }\n\n  },\n\n  created() {\n    this.getList();\n  }\n\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AAEA;AAEA;EACAA,YADA;EAEAC;IACAC,UADA;IAEAC;EAFA,CAFA;;EAMAC;IACA;MACAC,kBADA;MAEAC,aAFA;MAGAC,mBACA;QACAC,aADA;QAEAC,WAFA;QAGAC;MAHA,CADA,EAMA;QACAF,YADA;QAEAC,WAFA;QAGAC;MAHA,CANA,EAWA;QACAF,YADA;QAEAC,WAFA;QAGAC,cAHA;QAIAC,OACA;UACAF,UADA;UAEAG;QAFA,CADA,EAKA;UACAH,UADA;UAEAG;QAFA,CALA;MAJA,CAXA,EA0BA;QACAJ,cADA;QAEAC,aAFA;QAGAC;MAHA,CA1BA,EA+BA;QACAF,aADA;QAEAC,WAFA;QAGAC;MAHA,CA/BA,CAHA;MAwCAG;QACAb,QADA;QAEAc,QAFA;QAGAC,OAHA;QAIAC,SAJA;QAKAC;MALA,CAxCA;MA+CAC,YACA;QACAV,gBADA;QAEAC,SAFA;QAGAC;MAHA,CADA,CA/CA;MAsDAS;QACAC;MADA,CAtDA;MAyDAC,aAzDA;MA0DAC,aACA;QACAC,YADA;QAEAd;MAFA,CADA,EAKA;QACAc,WADA;QAEAd;MAFA,CALA,EASA;QACAc,gBADA;QAEAd;MAFA,CATA,EAaA;QACAc,aADA;QAEAd,aAFA;QAGAe;MAHA,CAbA,EAkBA;QACAD,YADA;QAEAd,WAFA;QAGAe;MAHA,CAlBA,CA1DA;MAkFAC;QACAC,OADA;QAEAC;MAFA;IAlFA;EAuFA,CA9FA;;EA+FAC;IACAC;MACA;MACA;QACA;QACA;UACAC;UACA;UACA;QACA,CAJA;MAKA,CAPA,MAOA;QACA;UACAA;UACA;UACA;QACA,CAJA;MAKA;IACA,CAjBA;;IAkBAC;MACA;MACA;MACA;QACA/B,QADA;QAEAc,QAFA;QAGAC,OAHA;QAIAC,SAJA;QAKAC;MALA;IAOA,CA5BA;;IA6BAe;MACA;MACA;MACA;IACA,CAjCA;;IAkCAC;MACA;QACAC,uBADA;QAEAC,sBAFA;QAGA;QACAzB;MAJA,GAKA0B,IALA,CAKA;QACA;QACA,WACAC,GADA,CACA,WADA,EACA;UACAC;YAAAC;UAAA;QADA,CADA,EAIAH,IAJA,CAIA;UACA;YACA1B,eADA;YAEA8B;UAFA;QAIA,CATA;QAUA;MACA,CAlBA;IAmBA,CAtDA;;IAuDA;IACAC;MACA;MACAzC;MACA0C;QACAhB,sBADA;QAEA1B;MAFA,GAGAoC,IAHA,CAGAO;QACA;QACAb;QACA;UACAc;UACA;QACA,CAHA;QAIA;QACA;MACA,CAZA;IAaA;;EAxEA,CA/FA;;EAyKAC;IACA;EACA;;AA3KA","names":["name","components","CommonForm","CommonTable","data","operateType","isShow","operateFormLabel","model","label","type","opts","value","operateForm","addr","age","birth","sex","formLabel","searchForm","keyword","tableData","tableLabel","prop","width","config","page","total","methods","confirm","console","addUser","editUser","delUser","confirmButtonText","cancelButtonText","then","get","params","id","message","getList","getUser","res","item","created"],"sourceRoot":"src/views/user","sources":["User.vue"],"sourcesContent":["<template>\n  <div class=\"manage\">\n    <el-dialog\n      :title=\"operateType === 'add' ? '新增用户' : '更新用户'\"\n      :visible.sync=\"isShow\"\n    >\n      <common-form\n        :formLabel=\"operateFormLabel\"\n        :form=\"operateForm\"\n        :inline=\"true\"\n        ref=\"form\"\n      ></common-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"isShow = false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirm\">确定</el-button>\n      </div>\n    </el-dialog>\n    <div class=\"manage-header\">\n      <el-button type=\"primary\" @click=\"addUser\">+新增</el-button>\n      <common-form\n        :formLabel=\"formLabel\"\n        :form=\"searchForm\"\n        :inline=\"true\"\n        ref=\"form\"\n      >\n        <el-button type=\"primary\" @click=\"getList(searchForm.keyword)\"\n          >搜索</el-button\n        >\n      </common-form>\n    </div>\n    <!-- config表示分页的配置数据 -->\n    <common-table\n      :tableData=\"tableData\"\n      :tableLabel=\"tableLabel\"\n      :config=\"config\"\n      @changePage=\"getList()\"\n      @edit=\"editUser\"\n      @del=\"delUser\"\n    ></common-table>\n  </div>\n</template>\n\n<script>\nimport CommonForm from '../../components/CommonForm.vue';\nimport CommonTable from '../../components/CommonTable.vue';\n\nimport { getUser } from \"../../../api/data\";\n\nexport default {\n  name: \"User\",\n  components: {\n    CommonForm,\n    CommonTable,\n  },\n  data() {\n    return {\n      operateType: \"add\",\n      isShow: false,\n      operateFormLabel: [\n        {\n          model: \"name\",\n          label: \"姓名\",\n          type: \"input\",\n        },\n        {\n          model: \"age\",\n          label: \"年龄\",\n          type: \"input\",\n        },\n        {\n          model: \"sex\",\n          label: \"性别\",\n          type: \"select\",\n          opts: [\n            {\n              label: \"男\",\n              value: 1,\n            },\n            {\n              label: \"女\",\n              value: 0,\n            },\n          ],\n        },\n        {\n          model: \"birth\",\n          label: \"出生日期\",\n          type: \"date\",\n        },\n        {\n          model: \"addr\",\n          label: \"地址\",\n          type: \"input\",\n        },\n      ],\n      operateForm: {\n        name: \"\",\n        addr: \"\",\n        age: \"\",\n        birth: \"\",\n        sex: \"\",\n      },\n      formLabel: [\n        {\n          model: \"keyword\",\n          label: \"\",\n          type: \"input\",\n        },\n      ],\n      searchForm: {\n        keyword: \"\",\n      },\n      tableData: [],\n      tableLabel: [\n        {\n          prop: \"name\",\n          label: \"姓名\",\n        },\n        {\n          prop: \"age\",\n          label: \"年龄\",\n        },\n        {\n          prop: \"sexLabel\",\n          label: \"性别\",\n        },\n        {\n          prop: \"birth\",\n          label: \"出生日期\",\n          width: 200,\n        },\n        {\n          prop: \"addr\",\n          label: \"地址\",\n          width: 320,\n        },\n      ],\n      config: {\n        page: 1,\n        total: 30,\n      },\n    };\n  },\n  methods: {\n    confirm() {\n      //判断当前为编辑还是新增\n      if (this.operateType === \"edit\") {\n        //更新table数组\n        this.$http.post(\"/user/edit\", this.operateForm).then((res) => {\n          console.log(\"编辑\" + res);\n          this.isShow = false;\n          this.getList();\n        });\n      } else {\n        this.$http.post(\"/user/add\", this.operateForm).then((res) => {\n          console.log(\"新增\" + res);\n          this.isShow = false;\n          this.getList();\n        });\n      }\n    },\n    addUser() {\n      this.isShow = true;\n      this.operateType = \"add\";\n      this.operateForm = {\n        name: \"\",\n        addr: \"\",\n        age: \"\",\n        birth: \"\",\n        sex: \"\",\n      };\n    },\n    editUser(row) {\n      this.operateType = \"edit\";\n      this.isShow = true;\n      this.operateForm = row;\n    },\n    delUser(row) {\n      this.$confirm(\"此操作将永久删除该数据，是否继续\", \"提示\", {\n        confirmButtonText: \"确认\",\n        cancelButtonText: \"取消\",\n        //弹窗类型\n        type: \"warning\",\n      }).then(() => {\n        const id = row.id;\n        this.$http\n          .get(\"/user/del\", {\n            params: { id },\n          })\n          .then(() => {\n            this.$message({\n              type: \"success\",\n              message: \"删除成功\",\n            });\n          });\n        this.getList();\n      });\n    },\n    //获取列表\n    getList(name = \"\") {\n      this.config.loading = true;\n      name ? (this.config.page = 1) : \"\";\n      getUser({\n        page: this.config.page,\n        name,\n      }).then((res) => {\n        //需要拿到的数据是res.data.list；解构赋值 给data起名为res\n        console.log(res.data);\n        this.tableData = res.data.list.map((item) => {\n          item.sexLabel = item.sex === 0 ? \"女\" : \"男\";\n          return item;\n        });\n        this.config.total = res.data.count;\n        this.config.loading = false;\n      });\n    },\n  },\n  created() {\n    this.getList();\n  },\n};\n</script>\n\n<style lang=\"less\" scoped>\n.manage-header {\n  display: flex;\n  /* 左右两边靠边 */\n  justify-content: space-between;\n  align-items: center;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}